SE AGREGÓ:
* MODIFICO AGREGAR Y EDITAR REINFO
* SE AGREGÓ 2 CAMPOS A REINFO 
* SE AGREGÓ 4 CAMPOS A REPORTE

--AGREGADO PARA VERSIONES 3 20/09/2021
ALTER TABLE TRAZABILIDAD.TRTBC_REINFO
  ADD V_SITUACIONINGEMMET VARCHAR(50),
  V_SITACIONDECMINERA VARCHAR(50);


--AGREGADO PARA VERSIONES 3 REPORTE 
ALTER TABLE TRAZABILIDAD.TRTBC_REPORTE
  ADD V_SITUACIONINGEMMET VARCHAR(50),
  V_SITACIONDECMINERA VARCHAR(50),
  V_ANIO VARCHAR(4),
  V_MES VARCHAR(15)

go

ALTER TABLE TRAZABILIDAD.TRTBC_REINFO ALTER COLUMN V_CONCLUSION varchar(max) 
  GO
  ALTER TABLE TRAZABILIDAD.TRTBC_REPORTE ALTER COLUMN V_CONCLUSION varchar(max) 
go

create PROCEDURE TRAZABILIDAD.TZ_LST_DOCUMENTOAYUDA
@V_TIPOIMAG VARCHAR(35),
@V_TIPOIGAFOM VARCHAR(50)
AS
SELECT * FROM TRAZABILIDAD.TRTBC_ARCHIVOS 
WHERE V_TIPOIMAG LIKE @V_TIPOIMAG AND V_TIPOIGAFOM like @V_TIPOIGAFOM 
AND V_ESTADO='A'

go

alter procedure TRAZABILIDAD.TZ_INS_REINFO 
@V_RUC varchar(11),
@V_PROVEEDOR VARCHAR(255) NULL,
@V_CODCONSECION varchar(50) null,
@V_NOMCONSECION varchar(100) null,
@N_TMPH decimal(18,3) , 
@N_TMPS decimal(18,3) ,
@V_UBIGEO varchar(20) null,
@V_NOMDERECHMINE varchar(255) null,
@V_CODZONAREI varchar(50),
@N_NORTE1 decimal(18,3),
@N_ESTE1 decimal(18,3),
@N_NORTE2 decimal(18,3),
@N_ESTE2 decimal(18,3),
@v_CODTIPOACT varchar(25) null,
@V_FECREINFO varchar(25) null,
@V_COMPONENT varchar(20) null,
@v_CODZONACAMP varchar(50) null,
@N_NORTEC decimal(18,3),
@N_ESTEC decimal(18,3),
@N_DIFCORDE decimal(18,3),
@N_SEDE int,
@V_DESCRILABOR varchar(255) null,
@N_CANTHOMBRE int,
@N_CANTMUJE int,
@N_TOTALTRAB int,
@V_IGAFOMCORREC varchar(25) null,
@V_IGAFOMPREV varchar(25) null,
@V_ESTADOIGAFOM VARCHAR(25) NULL,
@V_RESULTADOS VARCHAR(25) null,
@V_CONCLUSION varchar(max) null,
@V_USUREGISTRO varchar(25)null,
@V_ESTADO char(1) null,
@V_SITUACIONINGEMMET VARCHAR(50) null,
@V_SITACIONDECMINERA VARCHAR(50) null
as
insert into TRAZABILIDAD.TRTBC_REINFO(V_RUC,V_PROVEEDOR,V_CODCONSECION,V_NOMCONSECION,N_TMPH,N_TMPS,V_UBIGEO,V_NOMDERECHMINE,V_CODZONAREI,N_NORTE1,N_ESTE1,N_NORTE2,N_ESTE2,
v_CODTIPOACT,V_FECREINFO,V_COMPONENT,v_CODZONACAMP,N_NORTEC,N_ESTEC,N_DIFCORDE,N_SEDE,V_DESCRILABOR,N_CANTHOMBRE,N_CANTMUJE,N_TOTALTRAB,V_IGAFOMCORREC,V_IGAFOMPREV,V_ESTADOIGAFOM,
V_RESULTADOS,V_CONCLUSION,V_FECCREACION,V_USUREGISTRO,V_ESTADO,V_SITUACIONINGEMMET,V_SITACIONDECMINERA) values (@V_RUC,@V_PROVEEDOR,@V_CODCONSECION,@V_NOMCONSECION,@N_TMPH,@N_TMPS,@V_UBIGEO,
@V_NOMDERECHMINE,@V_CODZONAREI,@N_NORTE1,@N_ESTE1,@N_NORTE2,@N_ESTE2,@v_CODTIPOACT,@V_FECREINFO,@V_COMPONENT,@v_CODZONACAMP,@N_NORTEC,@N_ESTEC,@N_DIFCORDE,
@N_SEDE,@V_DESCRILABOR,@N_CANTHOMBRE,@N_CANTMUJE,@N_TOTALTRAB,@V_IGAFOMCORREC,@V_IGAFOMPREV,@V_ESTADOIGAFOM,@V_RESULTADOS,@V_CONCLUSION,getdate(),
@V_USUREGISTRO,@V_ESTADO,@V_SITUACIONINGEMMET,@V_SITACIONDECMINERA)

go
alter PROCEDURE TRAZABILIDAD.TZ_UPD_REINFO 
@N_CODREINFO INT,
@V_RUC varchar(11),
@V_CODCONSECION varchar(50),
@V_NOMCONSECION varchar(100),
@N_TMPH decimal(18,3),
@N_TMPS decimal(18,3),
@V_UBIGEO varchar(20),
@V_NOMDERECHMINE varchar(255),
@V_CODZONAREI varchar(50),
@N_NORTE1 decimal(18,3),
@N_ESTE1 decimal(18,3),
@N_NORTE2 decimal(18,3),
@N_ESTE2 decimal(18,3),
@v_CODTIPOACT varchar(25),
@V_FECREINFO varchar(25),
@V_COMPONENT varchar(20),
@v_CODZONACAMP varchar(50),
@N_NORTEC decimal(18,3),
@N_ESTEC decimal(18,3),
@N_DIFCORDE decimal(18,3),
@N_SEDE int,
@V_DESCRILABOR varchar(255),
@N_CANTHOMBRE int,
@N_CANTMUJE int,
@N_TOTALTRAB int,
@V_IGAFOMCORREC varchar(25),
@V_IGAFOMPREV varchar(25),
@V_ESTADOIGAFOM VARCHAR(25),
@V_RESULTADOS VARCHAR(25),
@V_CONCLUSION varchar(max),
@V_USUMODIF varchar(25),
@V_ESTADO char(1),
@V_SITUACIONINGEMMET VARCHAR(50) null,
@V_SITACIONDECMINERA VARCHAR(50) null
AS
UPDATE TRAZABILIDAD.TRTBC_REINFO SET V_RUC=@V_RUC,V_CODCONSECION=@V_CODCONSECION,V_NOMCONSECION=@V_NOMCONSECION,N_TMPH=@N_TMPH,N_TMPS=@N_TMPS,
V_UBIGEO=@V_UBIGEO,V_NOMDERECHMINE=@V_NOMDERECHMINE,V_CODZONAREI=@V_CODZONAREI,N_NORTE1=@N_NORTE1,N_ESTE1=@N_ESTE1,N_NORTE2=@N_NORTE2,N_ESTE2=@N_ESTE2,
v_CODTIPOACT=@v_CODTIPOACT,V_FECREINFO=@V_FECREINFO,V_COMPONENT=@V_COMPONENT,v_CODZONACAMP=@v_CODZONACAMP,N_NORTEC=@N_NORTEC,N_ESTEC=@N_ESTEC,N_DIFCORDE=@N_DIFCORDE,
N_SEDE=@N_SEDE,V_DESCRILABOR=@V_DESCRILABOR,N_CANTHOMBRE=@N_CANTHOMBRE,N_CANTMUJE=@N_CANTMUJE,N_TOTALTRAB=@N_TOTALTRAB,V_IGAFOMCORREC=@V_IGAFOMCORREC,V_IGAFOMPREV=@V_IGAFOMPREV,V_ESTADOIGAFOM=@V_ESTADOIGAFOM,
V_RESULTADOS=@V_RESULTADOS,V_CONCLUSION=@V_CONCLUSION,V_FECMODIF=getdate(),V_USUMODIF=@V_USUMODIF,V_ESTADO=@V_ESTADO,V_SITUACIONINGEMMET=@V_SITUACIONINGEMMET,V_SITACIONDECMINERA=@V_SITACIONDECMINERA
WHERE N_CODREINFO=@N_CODREINFO

go

ALTER PROCEDURE TRAZABILIDAD.TZ_GET_REINFOID  
@V_RUC VARCHAR(11),
@V_CODCONSECION VARCHAR(25)
AS
select N_CODREINFO,V_RUC,V_PROVEEDOR,V_CODCONSECION,V_NOMCONSECION,N_TMPH,N_TMPS,V_UBIGEO,V_NOMDERECHMINE,V_CODZONAREI,N_NORTE1,N_ESTE1,N_NORTE2,N_ESTE2,
v_CODTIPOACT,CONVERT(varchar,CONVERT(datetime,V_FECREINFO,121),103) as V_FECREINFO,V_COMPONENT,v_CODZONACAMP,N_NORTEC,N_ESTEC,N_DIFCORDE,N_SEDE,V_DESCRILABOR,N_CANTHOMBRE,N_CANTMUJE,N_TOTALTRAB,V_IGAFOMCORREC,V_IGAFOMPREV,
V_ESTADOIGAFOM,V_RESULTADOS,V_CONCLUSION,V_FECCREACION,V_FECMODIF,V_USUREGISTRO,V_USUMODIF,V_ESTADO,V_SITUACIONINGEMMET,V_SITACIONDECMINERA
FROM TRAZABILIDAD.TRTBC_REINFO WHERE V_RUC=@V_RUC AND V_CODCONSECION=@V_CODCONSECION

go

alter PROCEDURE TRAZABILIDAD.TZ_INS_REPORTE 
@N_CODREIN INT NULL,
@V_REALIZADOPOR VARCHAR(150) NULL,
@V_REVISADOPOR VARCHAR(150) NULL,
@V_FECHAREALIZADO varchar(25) NULL,
@V_FECHAREVISADO varchar(25) NULL,
--ZONA DE REINFO
@V_RUC varchar(11),
@V_PROVEEDOR VARCHAR(255) NULL,
@V_CODCONSECION varchar(50) null,
@V_NOMCONSECION varchar(100) null,
@N_TMPH decimal(18,3) , 
@N_TMPS decimal(18,3) ,
@V_UBIGEO varchar(20) null,
@V_NOMDERECHMINE varchar(255) null,
@V_CODZONAREI varchar(50),
@N_NORTE1 decimal(18,3),
@N_ESTE1 decimal(18,3),
@N_NORTE2 decimal(18,3),
@N_ESTE2 decimal(18,3),
@v_CODTIPOACT varchar(25) null,
@V_FECREINFO varchar(25) null,
@V_COMPONENT varchar(20) null,
@v_CODZONACAMP varchar(50) null,
@N_NORTEC decimal(18,3),
@N_ESTEC decimal(18,3),
@N_DIFCORDE decimal(18,3),
@N_SEDE int,
@V_DESCRILABOR varchar(255) null,
@N_CANTHOMBRE int,
@N_CANTMUJE int,
@N_TOTALTRAB int,
@V_IGAFOMCORREC varchar(25) null,
@V_IGAFOMPREV varchar(25) null,
@V_ESTADOIGAFOM VARCHAR(25) NULL,
@V_RESULTADOS VARCHAR(25) null,
@V_CONCLUSION varchar(max) null,
--FIN
@V_USUREGISTRO VARCHAR(25) NULL,
@V_PROTOCOLO varchar(30) null,
@N_VERSION int,
@V_VERSIONPROTOCOLO varchar(50),
@V_FECHAVERSION varchar(15),
@V_SITUACIONINGEMMET VARCHAR(50),
@V_SITACIONDECMINERA VARCHAR(50),
@V_ANIO VARCHAR(4),
@V_MES VARCHAR(15)
AS
INSERT INTO TRAZABILIDAD.TRTBC_REPORTE (N_CODREIN,V_REALIZADOPOR,V_REVISADOPOR,V_FECHAREALIZADO,
V_FECHAREVISADO,V_FECCREACION,V_USUREGISTRO,V_ESTADO,V_RUC,V_PROVEEDOR,V_CODCONSECION,V_NOMCONSECION,N_TMPH,N_TMPS,V_UBIGEO,V_NOMDERECHMINE,V_CODZONAREI,N_NORTE1,N_ESTE1,N_NORTE2,N_ESTE2,
v_CODTIPOACT,V_FECREINFO,V_COMPONENT,v_CODZONACAMP,N_NORTEC,N_ESTEC,N_DIFCORDE,N_SEDE,V_DESCRILABOR,N_CANTHOMBRE,N_CANTMUJE,N_TOTALTRAB,V_IGAFOMCORREC,V_IGAFOMPREV,V_ESTADOIGAFOM,
V_RESULTADOS,V_CONCLUSION,V_PROTOCOLO,N_VERSION,V_VERSIONPROTOCOLO,V_FECHAVERSION,V_SITUACIONINGEMMET,V_SITACIONDECMINERA,V_ANIO,V_MES)
VALUES(@N_CODREIN,@V_REALIZADOPOR,@V_REVISADOPOR,@V_FECHAREALIZADO,@V_FECHAREVISADO,GETDATE(),@V_USUREGISTRO,'A',@V_RUC,@V_PROVEEDOR,@V_CODCONSECION,@V_NOMCONSECION,@N_TMPH,@N_TMPS,@V_UBIGEO,
@V_NOMDERECHMINE,@V_CODZONAREI,@N_NORTE1,@N_ESTE1,@N_NORTE2,@N_ESTE2,@v_CODTIPOACT,@V_FECREINFO,@V_COMPONENT,@v_CODZONACAMP,@N_NORTEC,@N_ESTEC,@N_DIFCORDE,
@N_SEDE,@V_DESCRILABOR,@N_CANTHOMBRE,@N_CANTMUJE,@N_TOTALTRAB,@V_IGAFOMCORREC,@V_IGAFOMPREV,@V_ESTADOIGAFOM,@V_RESULTADOS,@V_CONCLUSION,@V_PROTOCOLO,@N_VERSION,@V_VERSIONPROTOCOLO,@V_FECHAVERSION,
@V_SITUACIONINGEMMET,@V_SITACIONDECMINERA,@V_ANIO,@V_MES
)
GO


alter PROCEDURE TRAZABILIDAD.TZ_GET_REPORTE 
@N_CODREPORTE INT NULL
AS
select N_CODREPORTE,N_CODREIN,V_REALIZADOPOR,V_REVISADOPOR,V_FECHAREALIZADO,
V_FECHAREVISADO,
CONVERT(varchar,CONVERT(datetime,V_FECCREACION,121),22) as V_FECCREACION,V_FECMODIF,V_USUREGISTRO,V_USUMODIF,V_ESTADO,V_RUC,V_PROVEEDOR,V_CODCONSECION,V_NOMCONSECION,N_TMPH,N_TMPS,V_UBIGEO,V_NOMDERECHMINE,V_CODZONAREI,N_NORTE1,N_ESTE1,N_NORTE2,N_ESTE2,
v_CODTIPOACT,CASE V_FECREINFO WHEN '' THEN V_FECREINFO WHEN ' ' THEN V_FECREINFO WHEN NULL THEN V_FECREINFO
           ELSE CONVERT(varchar,CONVERT(datetime,V_FECREINFO,121),103)
       END AS V_FECREINFO,V_COMPONENT,v_CODZONACAMP,N_NORTEC,N_ESTEC,N_DIFCORDE,N_SEDE,V_DESCRILABOR,N_CANTHOMBRE,N_CANTMUJE,N_TOTALTRAB,V_IGAFOMCORREC,V_IGAFOMPREV,
V_ESTADOIGAFOM,V_RESULTADOS,V_CONCLUSION,V_PROTOCOLO,N_VERSION,V_VERSIONPROTOCOLO,V_FECHAVERSION,V_SITUACIONINGEMMET,V_SITACIONDECMINERA,V_ANIO,V_MES
from  TRAZABILIDAD.TRTBC_REPORTE where N_CODREPORTE=@N_CODREPORTE and V_ESTADO='A'
GO

alter procedure TRAZABILIDAD.TZ_LST_REINFO
as
select N_CODREINFO,V_RUC,V_PROVEEDOR,V_CODCONSECION,V_NOMCONSECION,N_TMPH,N_TMPS,V_UBIGEO,V_NOMDERECHMINE,V_CODZONAREI,N_NORTE1,N_ESTE1,N_NORTE2,N_ESTE2,
	   v_CODTIPOACT,CASE V_FECREINFO WHEN '' THEN V_FECREINFO WHEN ' ' THEN V_FECREINFO WHEN NULL THEN V_FECREINFO
           ELSE CONVERT(varchar,CONVERT(datetime,V_FECREINFO,121),103)
       END AS V_FECREINFO,V_COMPONENT,v_CODZONACAMP,N_NORTEC,N_ESTEC,N_DIFCORDE,N_SEDE,V_DESCRILABOR,N_CANTHOMBRE,N_CANTMUJE,N_TOTALTRAB,V_IGAFOMCORREC,V_IGAFOMPREV,
V_ESTADOIGAFOM,V_RESULTADOS,V_CONCLUSION,V_FECCREACION,V_FECMODIF,V_USUREGISTRO,V_USUMODIF,V_ESTADO, 
(case when (select COUNT(*) from TRAZABILIDAD.TRTBC_ARCHIVOS WHERE 
N_CODREIN=TRAZABILIDAD.TRTBC_REINFO.N_CODREINFO AND V_TIPOIMAG='CARGOCORRECTIVO' and V_ESTADO='A')>0 then 1 else 0 end) 
as V_CARGOCORRECT,(case when (select COUNT(*) from TRAZABILIDAD.TRTBC_ARCHIVOS WHERE 
N_CODREIN=TRAZABILIDAD.TRTBC_REINFO.N_CODREINFO AND V_TIPOIMAG='CARGOPREVENTIVO' and V_ESTADO='A')>0 then 1 else 0 end) 
as V_CARGOPREVENT,(case when (select COUNT(*) from TRAZABILIDAD.TRTBC_ARCHIVOS WHERE 
N_CODREIN=TRAZABILIDAD.TRTBC_REINFO.N_CODREINFO AND V_TIPOIMAG='CARGOLEVSUS' and V_ESTADO='A')>0 then 1 else 0 end) 
as V_CARGOLEVSUS,(case when (select COUNT(*) from TRAZABILIDAD.TRTBC_ARCHIVOS WHERE 
N_CODREIN=TRAZABILIDAD.TRTBC_REINFO.N_CODREINFO AND V_TIPOARCH='DECLARACIONMINERA' and  V_ESTADO='A')>0 then 1 else 0 end) 
as V_CARGODECMINERA,(case when (select COUNT(*) from TRAZABILIDAD.TRTBC_ARCHIVOS WHERE 
N_CODREIN=TRAZABILIDAD.TRTBC_REINFO.N_CODREINFO AND V_TIPOIGAFOM='CONTRATO' and  V_ESTADO='A' AND N_CODIGAFOM=5)>0 then 1 else 0 end) 
as V_CONTRATO,(case when (select COUNT(*) from TRAZABILIDAD.TRTBC_ARCHIVOS WHERE 
N_CODREIN=TRAZABILIDAD.TRTBC_REINFO.N_CODREINFO AND V_TIPOIGAFOM='RESOLUCION' and  V_ESTADO='A' AND N_CODIGAFOM=5)>0 then 1 else 0 end) 
as V_RESOLUCION,(case when (select COUNT(*) from TRAZABILIDAD.TRTBC_ARCHIVOS WHERE 
N_CODREIN=TRAZABILIDAD.TRTBC_REINFO.N_CODREINFO AND V_TIPOIGAFOM='OTROS' and  V_ESTADO='A' AND N_CODIGAFOM=5)>0 then 1 else 0 end) 
as V_OTROSDOCS,(case when (select COUNT(*) from TRAZABILIDAD.TRTBC_ARCHIVOS WHERE 
N_CODREIN=TRAZABILIDAD.TRTBC_REINFO.N_CODREINFO AND V_TIPOIGAFOM='RESOLUCION' and  V_ESTADO='A' AND N_CODIGAFOM=1)>0 then 1 else 0 end) 
as V_RESOLUCIONIGAFOM
from TRAZABILIDAD.TRTBC_REINFO  
where V_ESTADO='A'
go

--CAMBIO BD 16/09/2021 (SE AGREGÓ PARA MODULO FORMALIZADOS)
alter procedure TRAZABILIDAD.TZ_LIST_FILTRARREINFO 
@V_RUC VARCHAR(11) ,
@V_PROVEEDOR VARCHAR(255) ,
@V_CODCONSECION VARCHAR(50) ,
@V_NOMCONSECION VARCHAR(100) ,
@V_NOMDERECHMINE VARCHAR(255) ,
@V_FECREINFO VARCHAR(25) ,
@V_RESULTADOS VARCHAR(25),
@N_SEDE int
as
select N_CODREINFO,V_RUC,V_PROVEEDOR,V_CODCONSECION,V_NOMCONSECION,N_TMPH,N_TMPS,V_UBIGEO,V_NOMDERECHMINE,V_CODZONAREI,N_NORTE1,N_ESTE1,N_NORTE2,N_ESTE2,
	   v_CODTIPOACT,CASE V_FECREINFO WHEN '' THEN V_FECREINFO WHEN ' ' THEN V_FECREINFO WHEN NULL THEN V_FECREINFO
           ELSE CONVERT(varchar,CONVERT(datetime,V_FECREINFO,121),103)
       END AS V_FECREINFO,V_COMPONENT,v_CODZONACAMP,N_NORTEC,N_ESTEC,N_DIFCORDE,N_SEDE,V_DESCRILABOR,N_CANTHOMBRE,N_CANTMUJE,N_TOTALTRAB,V_IGAFOMCORREC,V_IGAFOMPREV,
V_ESTADOIGAFOM,V_RESULTADOS,V_CONCLUSION,V_FECCREACION,V_FECMODIF,V_USUREGISTRO,V_USUMODIF,V_ESTADO, 
(case when (select COUNT(*) from TRAZABILIDAD.TRTBC_ARCHIVOS WHERE 
N_CODREIN=TRAZABILIDAD.TRTBC_REINFO.N_CODREINFO AND V_TIPOIMAG='CARGOCORRECTIVO' and V_ESTADO='A')>0 then 1 else 0 end) 
as V_CARGOCORRECT,(case when (select COUNT(*) from TRAZABILIDAD.TRTBC_ARCHIVOS WHERE 
N_CODREIN=TRAZABILIDAD.TRTBC_REINFO.N_CODREINFO AND V_TIPOIMAG='CARGOPREVENTIVO' and V_ESTADO='A')>0 then 1 else 0 end) 
as V_CARGOPREVENT,(case when (select COUNT(*) from TRAZABILIDAD.TRTBC_ARCHIVOS WHERE 
N_CODREIN=TRAZABILIDAD.TRTBC_REINFO.N_CODREINFO AND V_TIPOIMAG='CARGOLEVSUS' and V_ESTADO='A')>0 then 1 else 0 end) 
as V_CARGOLEVSUS,(case when (select COUNT(*) from TRAZABILIDAD.TRTBC_ARCHIVOS WHERE 
N_CODREIN=TRAZABILIDAD.TRTBC_REINFO.N_CODREINFO AND V_TIPOARCH='DECLARACIONMINERA' and  V_ESTADO='A')>0 then 1 else 0 end) 
as V_CARGODECMINERA,(case when (select COUNT(*) from TRAZABILIDAD.TRTBC_ARCHIVOS WHERE 
N_CODREIN=TRAZABILIDAD.TRTBC_REINFO.N_CODREINFO AND V_TIPOIGAFOM='CONTRATO' and  V_ESTADO='A' AND N_CODIGAFOM=5)>0 then 1 else 0 end) 
as V_CONTRATO,(case when (select COUNT(*) from TRAZABILIDAD.TRTBC_ARCHIVOS WHERE 
N_CODREIN=TRAZABILIDAD.TRTBC_REINFO.N_CODREINFO AND V_TIPOIGAFOM='RESOLUCION' and  V_ESTADO='A' AND N_CODIGAFOM=5)>0 then 1 else 0 end) 
as V_RESOLUCION,(case when (select COUNT(*) from TRAZABILIDAD.TRTBC_ARCHIVOS WHERE 
N_CODREIN=TRAZABILIDAD.TRTBC_REINFO.N_CODREINFO AND V_TIPOIGAFOM='OTROS' and  V_ESTADO='A' AND N_CODIGAFOM=5)>0 then 1 else 0 end) 
as V_OTROSDOCS,(case when (select COUNT(*) from TRAZABILIDAD.TRTBC_ARCHIVOS WHERE 
N_CODREIN=TRAZABILIDAD.TRTBC_REINFO.N_CODREINFO AND V_TIPOIGAFOM='RESOLUCION' and  V_ESTADO='A' AND N_CODIGAFOM=1)>0 then 1 else 0 end) 
as V_RESOLUCIONIGAFOM
from TRAZABILIDAD.TRTBC_REINFO  
where V_FECREINFO LIKE @V_FECREINFO and V_RUC LIKE @V_RUC AND V_PROVEEDOR LIKE @V_PROVEEDOR AND V_CODCONSECION LIKE @V_CODCONSECION
AND V_NOMCONSECION LIKE '%'+@V_NOMCONSECION AND V_NOMDERECHMINE LIKE @V_NOMDERECHMINE
AND V_RESULTADOS LIKE @V_RESULTADOS and V_ESTADO='A' 
and  N_SEDE = iif(@N_SEDE=0, N_SEDE ,@N_SEDE)

GO
